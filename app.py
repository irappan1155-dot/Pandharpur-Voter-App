import streamlit as st
import pandas as pd

# рдкреЗрдЬрдЪреА рд░рдЪрдирд╛
st.set_page_config(page_title="рдорддрджрд╛рд░ рд╢реЛрдз рдкреНрд░рдгрд╛рд▓реА", layout="centered")

st.title("ЁЯЧ│я╕П рдкрдВрдврд░рдкреВрд░ рд╡рд┐рдзрд╛рдирд╕рднрд╛ рд╢реЛрдз рдкреНрд░рдгрд╛рд▓реА")
st.subheader("рдорд░рд╡рдбреЗ - рдорддрджрд╛рд░ рдпрд╛рджреА рд╕рд░реНрдЪ")

# рдбреЗрдЯрд╛ рд▓реЛрдб рдХрд░рдгреЗ
@st.cache_data
def load_data():
    df = pd.read_csv("voter_data.csv")
    return df

try:
    df = load_data()
    
    # рд╕рд░реНрдЪ рдмрд╛рд░
    search_query = st.text_input("рдирд╛рд╡ рдХрд┐рдВрд╡рд╛ рдорддрджрд╛рд░ рдХрд╛рд░реНрдб рдХреНрд░рдорд╛рдВрдХ (Epic No) рдЯрд╛рдХрд╛:", placeholder="рдЙрджрд╛. рдЧрдгрдкрддреАрд▓ рдХрд┐рдВрд╡рд╛ SZH...")

    if search_query:
        # рдирд╛рд╡рд╛рдд рдХрд┐рдВрд╡рд╛ рдорддрджрд╛рд░ рдХрд╛рд░реНрдб рдХреЙрд▓рдордордзреНрдпреЗ рд╢реЛрдзрдгреЗ
        mask = df.apply(lambda row: row.astype(str).str.contains(search_query, case=False).any(), axis=1)
        results = df[mask]

        if not results.empty:
            st.success(f"{len(results)} рдорддрджрд╛рд░ рд╕рд╛рдкрдбрд▓реЗ")
            # рдЯреЗрдмрд▓ рд╕реНрд╡рд░реВрдкрд╛рдд рдорд╛рд╣рд┐рддреА рджрд╛рдЦрд╡рдгреЗ
            st.dataframe(results, use_container_width=True)
        else:
            st.error("рдорд╛рд╣рд┐рддреА рд╕рд╛рдкрдбрд▓реА рдирд╛рд╣реА. рдХреГрдкрдпрд╛ рдирд╛рд╡ рддрдкрд╛рд╕рд╛.")
    else:
        st.info("рдЯреАрдк: рддреБрдореНрд╣реА рдЖрдбрдирд╛рд╡ (рдЙрджрд╛. рдЧрдгрдкрддреАрд▓) рдЯрд╛рдХреВрдирд╣реА рд╕рдВрдкреВрд░реНрдг рдпрд╛рджреА рдкрд╛рд╣реВ рд╢рдХрддрд╛.")

except Exception as e:
    st.error("рдХрд╛рд╣реАрддрд░реА рддрд╛рдВрддреНрд░рд┐рдХ рдЕрдбрдЪрдг рдЖрд▓реА рдЖрд╣реЗ. рдХреГрдкрдпрд╛ рддреБрдордЪреА CSV рдлрд╛рдИрд▓ рддрдкрд╛рд╕рд╛.")
